```markdown
# Инструмент визуализации графа зависимостей

## Вариант №16

Инструмент для анализа и визуализации графа зависимостей пакетов Rust/Cargo из репозитория crates.io.

---

## Этап 1: Минимальный прототип с конфигурацией

Реализовано минимальное CLI-приложение с гибкой системой конфигурации через INI-файлы.

### Функциональность:
- **Конфигурация INI**: чтение параметров из файла `config.ini`
- **Параметры конфигурации**:
  - `package_name` - имя анализируемого пакета
  - `repo_url` - URL репозитория Cargo
  - `test_mode` - режим тестирования (true/false)
  - `output_file` - имя файла для сохранения графа
  - `max_depth` - максимальная глубина анализа
  - `filter_substring` - подстрока для фильтрации пакетов
- **Валидация параметров**: проверка обязательных полей и типов
- **Вывод конфигурации**: отображение всех параметров в формате ключ-значение
- **Обработка ошибок**: отсутствие файла, неверный формат, невалидные значения

### Использование:
```bash
python -m src.cli
```

### Пример работы:
```
=== Инструмент визуализации графа зависимостей ===
Этап 1: Минимальный прототип с конфигурацией

Параметры конфигурации:
========================================
package_name          : serde
repo_url              : https://crates.io
test_mode             : нет
output_file           : graph.svg
max_depth             : 5
filter_substring      : test
========================================

Готов к анализу пакета: serde
Режим: ПРОД (данные из: https://crates.io)
Макс. глубина анализа: 5
Фильтрация пакетов: исключаются пакеты содержащие 'test'
Результат будет сохранен в: graph.svg
```

### Структура конфигурационного файла (config.ini):
```ini
[settings]
package_name = serde
repo_url = https://crates.io
test_mode = false
output_file = graph.svg
max_depth = 5
filter_substring = test
```

---

## Этап 2: Сбор данных о зависимостях

Реализована основная логика получения данных о зависимостях пакетов из Cargo API.

### Функциональность:
- **Cargo API клиент**: взаимодействие с crates.io API
- **Два режима работы**:
  - **Прод режим**: реальные данные из API
  - **Тестовый режим**: локальные демонстрационные данные
- **Получение информации о пакете**: название, версия, описание
- **Извлечение зависимостей**: прямые зависимости пакета
- **Вывод зависимостей**: отображение списка прямых зависимостей
- **Обработка ошибок**: сетевые ошибки, неверные ответы API, пакет не найден

### Использование:
```bash
# Прод режим (реальные данные из API)
python -m src.cli

# Тестовый режим (демонстрационные данные)
# Измените test_mode = true в config.ini
```

### Пример работы (Прод режим):
```
=== Инструмент визуализации графа зависимостей ===
Этап 2: Сбор данных о зависимостях

Параметры конфигурации:
========================================
package_name          : serde
repo_url              : https://crates.io
test_mode             : нет
output_file           : graph.svg
max_depth             : 5
filter_substring      : test
========================================

Режим: ПРОД
Получение информации о пакете: serde
Последняя версия: 1.0.228
Найдено зависимостей: 2

ПРЯМЫЕ ЗАВИСИМОСТИ ПАКЕТА 'serde':
==================================================
 1. serde_core
 2. serde_derive
==================================================

Этап 2 завершен успешно!
```

### Пример работы (Тестовый режим):
```
=== Инструмент визуализации графа зависимостей ===
Этап 2: Сбор данных о зависимостях

Параметры конфигурации:
========================================
package_name          : serde
repo_url              : https://crates.io
test_mode             : да
output_file           : graph.svg
max_depth             : 5
filter_substring      : test
========================================

Режим: ТЕСТИРОВАНИЕ

ТЕСТОВЫЕ ЗАВИСИМОСТИ ПАКЕТА 'serde':
==================================================
 1. serde_derive
 2. proc-macro2
 3. quote
 4. syn
==================================================
Режим ТЕСТИРОВАНИЯ - используются локальные данные

Этап 2 завершен успешно!
```

---

## Этап 3: Основные операции над графом зависимостей

Реализовано построение полного графа зависимостей с учетом транзитивности и выполнение основных операций.

### Функциональность:
- **Алгоритм BFS с рекурсией**: построение транзитивного графа зависимостей
- **Обработка циклических зависимостей**: обнаружение и визуализация циклов
- **Многоуровневая фильтрация**: исключение пакетов на этапах построения и обхода
- **Ограничение глубины анализа**: контроль рекурсии через max_depth
- **Тестовый граф**: демонстрация сложных случаев с циклами
- **Статистика графа**: подсчет пакетов и зависимостей

### Использование:
```bash
# Построение графа с ограничением глубины
# Установите max_depth = 2 в config.ini

# Построение графа с фильтрацией
# Установите filter_substring = "test" в config.ini
```

### Пример работы (Тестовый режим с циклами):
```
=== Инструмент визуализации графа зависимостей ===
Этап 3: Основные операции над графом зависимостей

Параметры конфигурации:
========================================
package_name          : A
repo_url              : https://crates.io
test_mode             : да
output_file           : graph.svg
max_depth             : 5
filter_substring      : test
========================================

Режим: ТЕСТИРОВАНИЕ

==================================================
ДЕМОНСТРАЦИЯ АЛГОРИТМОВ НА ТЕСТОВОМ ГРАФЕ
==================================================
ТЕСТОВЫЙ ГРАФ:
ГРАФ ЗАВИСИМОСТЕЙ (9 пакетов):
==================================================
A
   └── зависит от: B, C
B
   └── зависит от: D, E
C
   └── зависит от: B, F
D
   └── зависит от: G
E
   └── зависит от: D, H
F
   └── зависит от: E, I
G
   └── зависит от: B
H (нет зависимостей)
I
   └── зависит от: F
==================================================
ОБНАРУЖЕНЫ ЦИКЛЫ:
   Цикл 1: B → D → G → B
   Цикл 2: F → I → F

ПОСТРОЕНИЕ ГРАФА ДЛЯ 'A':
Построение графа зависимостей для 'A'...
   Макс. глубина: 5
Граф построен: 9 пакетов, 11 зависимостей

ГРАФ ЗАВИСИМОСТЕЙ (9 пакетов):
==================================================
A
   └── зависит от: B, C
B
   └── зависит от: D, E
...
==================================================

Этап 3 завершен успешно!
```

### Пример работы (Прод режим с фильтрацией):
```
Построение графа зависимостей для 'serde'...
   Макс. глубина: 2
   Фильтр: исключаются пакеты содержащие 'test'
Пакет отфильтрован: serde_test_utils
Зависимость отфильтрована: integration_test
Граф построен: 8 пакетов, 12 зависимостей
```

---

## Структура проекта

```
dependency-visualizer/
├── src/
│   ├── __init__.py          # Инициализация пакета
│   ├── config.py            # Работа с конфигурацией INI
│   ├── fetcher.py           # Клиент Cargo API и тестовые данные
│   ├── graph.py             # Построение графа зависимостей
│   └── cli.py               # Основной CLI интерфейс
├── config.ini               # Файл конфигурации
├── requirements.txt         # Зависимости проекта
└── README.md               # Документация
```

### Основные модули:

- **`config.py`**: Класс `Config` для работы с INI конфигурацией
  - `load_config()` - загрузка и парсинг конфигурации
  - `_validate_config()` - валидация параметров
  - `display_config()` - вывод параметров (требование этапа 1)

- **`fetcher.py`**: Классы для получения данных о зависимостях
  - `CargoAPIFetcher` - клиент для Cargo API (прод режим)
  - `TestDataFetcher` - тестовые данные (тестовый режим)
  - `get_direct_dependencies()` - получение прямых зависимостей

- **`graph.py`**: Классы для работы с графом зависимостей
  - `DependencyGraph` - построение и анализ графа
  - `TestGraphBuilder` - тестовый граф для демонстрации
  - `build_dependency_graph()` - BFS с рекурсией
  - `detect_cycles()` - обнаружение циклических зависимостей

- **`cli.py`**: Основной интерфейс командной строки
  - `main()` - точка входа приложения
  - Интеграция всех модулей

---

## Установка и запуск

### Требования:
- Python 3.8+
- Доступ к интернету (для прод режима)

### Установка:
```bash
# Клонирование репозитория
git clone <repository-url>
cd dependency-visualizer

# Создание виртуального окружения (рекомендуется)
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# Запуск приложения
python -m src.cli
```

### Настройка:
Отредактируйте файл `config.ini` для изменения параметров анализа.

---

## История разработки

- **Этап 1**: Минимальный прототип с конфигурацией INI
- **Этап 2**: Сбор данных о зависимостях из Cargo API
- **Этап 3**: Основные операции над графом зависимостей

---

## Технические особенности

- **Использование только стандартных библиотек** Python (соответствие требованиям)
- **Гибкая архитектура** с поддержкой разных режимов работы
- **Полная обработка ошибок** на всех этапах работы
- **Модульная структура** для легкого расширения функциональности
- **Многоуровневая фильтрация** для эффективного построения графа
```